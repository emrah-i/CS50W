{% extends "network/layout.html" %}
{% load myfilter %}
{% load static %}

{% block body %}
<div id="dialog_backdrop"></div>
    <div id="following_users_popup" style="display:none">
        <dialog open>  
            <button class="btn" type="button" id="close_following"><i class="fa-solid fa-x" style="color: #ffffff;"></i></button>       
            <h2>Following</h2>                   
            <div id="following_content">
                <table>
                    <thead>
                        <th>Username</th>
                        {% if user.username == user_info.username %}
                        <th id="left-border">Unfollow</th>
                        {% endif %}
                    </thead>
                    {% if following_users|length > 0 %}
                        {% for dif_user in following_users %}
                        <tr>
                            <td id="col"><a href="{% url 'profile' dif_user.username %}?sort={{ sort }}" id="profile_user_link">{{ dif_user.username }}</a></td>
                            {% if user.username == user_info.username %}
                            <td id="col"><button class="btn" id="unfollow_button" data-userid="{{ dif_user.id }}">Unfollow</button></td>
                            {% endif %}
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="2">No Following</td>
                        </tr>
                    {% endif %}
                </table>
            </div>
        </dialog>
    </div>
    <div id="followers_user_popup" style="display:none">
        <dialog open>  
            <button class="btn" type="button" id="close_followers"><i class="fa-solid fa-x" style="color: #ffffff;"></i></button>  
            <h2>Followers</h2>            
            <div id="follower_content">
                <table>
                    <thead>
                        <th>Username</th>
                        {% if user.username == user_info.username %}
                        <th id="left-border">Remove</th>
                        {% endif %}
                    </thead>
                    {% if follower_users|length > 0 %}
                        {% for dif_user in follower_users %}
                        <tr>
                            <td id="col"><a href="{% url 'profile' dif_user.username %}?sort={{ sort }}" id="profile_user_link">{{ dif_user.username }}</a></td>
                            {% if user.username == user_info.username %}
                            <td id="col"><button class="btn" id="remove_follower_button" data-userid="{{ dif_user.id }}">Remove</button></td>
                            {% endif %}
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="2">No Followers</td>
                        </tr>
                    {% endif %}
                </table>
            </div>
        </dialog>
    </div>
    <div id="profile_posts">
        <div id="user_info">
            <table>
                <tr>
                    <td>
                        <img src="{% static user_info.avatar %}" alt="My Image"></img>
                    </td>
                    <td  width="30%">
                        <h3>{{ user_info.username }}</h3>
                        <p><span id="open_followers">Followers: {{ user_info.followers }}</span></p>
                        <p><span id="open_following">Following: {{ user_info.following }}</span></p>
                    </td>
                </tr>
                <tr>
                    <td>{{ user_info.bio }}</td>
                </tr>
                <tr>
                    <td>
                        {% if user.is_authenticated and user.username != user_info.username %}
                            {% if current_user_following == True %}
                                <button class="btn" id="unfollow_button" data-userid="{{ user_info.id }}">Unfollow</button>
                            {% elif current_user_following == False %}
                                <button class="btn" id="follow_button" data-userid="{{ user_info.id }}">Follow</button>
                            {% endif %}
                        {% endif %}
                        {% if user.is_authenticated and user.username == user_info.username %}
                                <button class="btn" type="button" id="edit_profile_button">Edit Profile</button>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
        <div id="main_profile_div">
            <div class="row" id="main_filters">
                <div class="col"><h3>All Posts</h3></div>
                <div class="col" id="row1">
                    <label style="display:inline">Sort By:</label>
                    <select id="sort">
                        <option selected value="new_old">Newest to Oldest</option>
                        <option value="old_new">Oldest to Newest</option>
                        <option value="most_likes">Most Likes</option>
                        <option value="least_likes">Least Likes</option>
                        <option value="most_comments">Most Comments</option>
                        <option value="least_comments">Least Comments</option>
                    </select>
                </div>
            </div>
            <div class="container-fluid all_posts justify-content-center">
            </div>
        </div>
    </div>
{% endblock %}